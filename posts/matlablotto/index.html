<!DOCTYPE html><html lang="ko-KR" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자!" /><meta name="author" content="Simon Anderson" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="1. Introduce" /><meta property="og:description" content="1. Introduce" /><link rel="canonical" href="https://simonwithwoogi.github.io/posts/matlablotto/" /><meta property="og:url" content="https://simonwithwoogi.github.io/posts/matlablotto/" /><meta property="og:site_name" content="몬기의 기술공방" /><meta property="og:image" content="https://simonwithwoogi.github.io/assets/img/MATLAB/11_Preview.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-24T19:55:00+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://simonwithwoogi.github.io/assets/img/MATLAB/11_Preview.png" /><meta property="twitter:title" content="MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자!" /><meta name="twitter:site" content="@no-name" /><meta name="twitter:creator" content="@Simon Anderson" /><meta name="google-site-verification" content="Simon Anderson verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Simon Anderson"},"description":"1. Introduce","url":"https://simonwithwoogi.github.io/posts/matlablotto/","@type":"BlogPosting","image":"https://simonwithwoogi.github.io/assets/img/MATLAB/11_Preview.png","headline":"MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자!","dateModified":"2021-02-24T19:55:00+09:00","datePublished":"2021-02-24T19:55:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://simonwithwoogi.github.io/posts/matlablotto/"},"@context":"https://schema.org"}</script><title>MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자! | 몬기의 기술공방</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/Blog_logo_210213.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">몬기의 기술공방</a></div><div class="site-subtitle font-italic">Simon with Woogi</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/SimonWithWoogi" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/no-name" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['simon.anderson.tech','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자!</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자!</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Simon Anderson </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Feb 24, 2021, 7:55 PM +0900" prep="on" > Feb 24 <i class="unloaded">2021-02-24T19:55:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3248 words">18 min</span></div></div><div class="post-content"><h2 id="1-introduce"><span style="color:darkblue">1. Introduce</span></h2><p><strong>이번 포스팅은 재미로 구축했으니, 너무 많은 돈을 쓰지마세요. 로또는 도박입니다.</strong></p><p>저는 돈에 큰 관심이 없습니다. 어렸을 때 가정형편이 매우 어려웠으나, 모든 가족이 다같이 노력했고 상황이 많이 나아졌습니다. 이 과정속에 돈보다는 인류애적 가치를 더 중요하게 생각하는 사람이 됐습니다. 그래도 로또 5000원은 일주일을 두근거리게 하죠.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_1.png" alt="집게사장과로또" /></p><h3 id="11-lotto-in-korea"><span style="color:darkblue">1.1. Lotto in Korea</span></h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_2.png" alt="로또 마크" /></p><p>로또는 <code class="language-plaintext highlighter-rouge">1-45</code> 사이에서 <code class="language-plaintext highlighter-rouge">중복없이 6개</code> 의 숫자를 선택합니다. 끝으로 보너스 숫자인 하나를 더 추출합니다. 그렇게 보너스 숫자 포함한 총 <code class="language-plaintext highlighter-rouge">7</code> 개의 숫자맞추기 놀이 입니다. <code class="language-plaintext highlighter-rouge">1000원</code> 당 하나의 티켓을 살 수 있구요. <code class="language-plaintext highlighter-rouge">5000원</code> 으로 한 세트를 살 수 있습니다. 여담으로 저는 로또에 대해서 잘 모릅니다. 이번에 이 코드를 구현하면서 로또룰을 알게 됐고 <strong>앞으로 진행하는 내용은 데이터를 기반으로한 로또 당첨번호 에측입니다.</strong></p><h3 id="12-winning-lottery-numbers"><span style="color:darkblue">1.2. Winning lottery numbers</span></h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_3.png" alt="당첨번호들" /></p><p>저는 두 가지를 적용할 예정입니다. 첫 번째는 <code class="language-plaintext highlighter-rouge">번호별 통계</code> 를 가져와, 가장 많이 나온 번호 15개중에서 3개, 가장 적게 나온 번호 15개중에서 2개, 중간 번호 15개중에서 1개씩 추출하여 총 6개의 번호를 만들 것이고 두 번째는 <code class="language-plaintext highlighter-rouge">LSTM</code> 을 이용하여 총 45개의 번호들이 추출되는 주기를 뽑아 회차마다 번호를 구할 수 있습니다. 끝으로 이 두가지 구조를 조합해서, <code class="language-plaintext highlighter-rouge">LSTM</code> 으로 구한 번호들중에서 발생빈도에 따라 가중치를 적용하겠습니다.</p><h2 id="2-binomial-time-series-lstm"><span style="color:darkblue">2. Binomial time series LSTM</span></h2><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_4.png" alt="플로우" /></p><p>해당 내용은 <code class="language-plaintext highlighter-rouge">RNN</code> 과<code class="language-plaintext highlighter-rouge">LSTM</code> 에 대한 기본적인 이론과 <code class="language-plaintext highlighter-rouge">시계열 분석</code> 에 대한 <code class="language-plaintext highlighter-rouge">LSTM</code> 그리고 <code class="language-plaintext highlighter-rouge">이진 시계열 LSTM</code> 을 순서대로 설명한 다음, <code class="language-plaintext highlighter-rouge">MATLAB</code> 구현 코드로 넘어가겠습니다.</p><h3 id="21-recurrent-nerual-network"><span style="color:darkblue">2.1. Recurrent Nerual Network</span></h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_5.png" alt="RNN" /></p><p><code class="language-plaintext highlighter-rouge">RNN</code> 이란 <code class="language-plaintext highlighter-rouge">되풀이(Recurrent)</code> 되는 성질을 이용하여, 앞 전에 있는 데이터객체를 일련의 과정에 있다고 받아들이는 모델인데요. 일련의 과정을 설명할 수 있는 <code class="language-plaintext highlighter-rouge">문장, 동영상</code> 이나 <code class="language-plaintext highlighter-rouge">수요예측</code> 에 쓸 수 있습니다. <code class="language-plaintext highlighter-rouge">RNN</code> 은 <code class="language-plaintext highlighter-rouge">CNN</code> 과 다르게 입력, 출력을 자유롭게 구조를 쓸 수 있습니다. 이는 <code class="language-plaintext highlighter-rouge">LSTM</code> 에도 이어집니다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_6.png" alt="RNN여러구조" /></p><p><code class="language-plaintext highlighter-rouge">one-many</code>는 하나가 들어와 여러 출력을 가지게 합니다. 예를 들면 한 이미지 안에서 여러 객체를 찾을 수 있죠. <code class="language-plaintext highlighter-rouge">many-one</code> 은 여러 출력들 속에서 하나를 반환합니다. 영화 리뷰를 다 읽어와 얼마나 긍정적인 반응인지 알 수 있습니다. 끝으로 <code class="language-plaintext highlighter-rouge">many-many</code> 는 번역이 대표적인 예입니다.</p><h3 id="22-long-short-term-memory"><span style="color:darkblue">2.2. Long Short-Term Memory</span></h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_7_1.png" alt="LSTM활성함수" /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_7_2.png" alt="LSTM활성함수" /></p><p><code class="language-plaintext highlighter-rouge">LSTM</code> 은 <code class="language-plaintext highlighter-rouge">RNN(Recurrent Neural Network)</code> 에서 파생된 모델입니다. <code class="language-plaintext highlighter-rouge">MATLAB</code> 에 적혀있는 <code class="language-plaintext highlighter-rouge">활성함수</code> 단을 보겠습니다. 선택할 수 있는게 몇 개 없네요. 순환 신경망 레이어 특성상 <code class="language-plaintext highlighter-rouge">선형 활성함수</code>는 비효율적입니다. 체인룰을 적용했을 때 히든레이어에서 조정할 가중치는 따로 없어지고 계수만 남게되는데요. 아래의 내용은 <a href="https://kr.mathworks.com/help/deeplearning/ref/nnet.cnn.layer.lstmlayer.html#mw_8cad7fee-7610-4134-9354-b7ed3a45204d">MATLAB 도움말</a> 을 그대로 가져왔습니다. 학술적 내용이니 넘어가셔도 됩니다. </p><hr /><p>LSTM 계층은 시계열 및 시퀀스 데이터에서 시간 스텝 간의 장기 종속성을 학습합니다.</p><p>계층의 상태는 <strong>은닉 상태</strong>(<strong>출력 상태</strong>)와 <strong>셀 상태</strong>로 구성됩니다. 시간 스텝 t에서의 은닉 상태는 이 시간 스텝에 대한 LSTM 계층의 출력값을 포함합니다. 셀 상태는 이전 시간 스텝에서 학습한 정보를 포함합니다. 이 계층은 각 시간 스텝에서 셀 상태에 정보를 추가하거나 셀 상태로부터 정보를 제거합니다. 계층은 <strong>게이트</strong>를 사용하여 이러한 업데이트를 제어합니다.</p><p>다음 구성요소는 계층의 셀 상태와 은닉 상태를 제어합니다.</p><div class="table-wrapper"><table><thead><tr><th>구성요소<th>목적<tbody><tr><td>입력 게이트(i)<td>셀 상태 업데이트의 수준 제어<tr><td>망각 게이트(f)<td>셀 상태 재설정(망각)의 수준 제어<tr><td>셀 후보(g)<td>셀 상태에 정보 추가<tr><td>출력 게이트(o)<td>은닉 상태에 추가되는 셀 상태의 수준 제어</table></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_8.png" alt="LSTM구조" /></p><p>LSTM 계층의 학습 가능한 가중치는 입력 가중치W(<code class="language-plaintext highlighter-rouge">InputWeights</code>), 순환 가중치R(<code class="language-plaintext highlighter-rouge">RecurrentWeights</code>), 편향b(<code class="language-plaintext highlighter-rouge">Bias</code>)입니다. 행렬 W, R, b는 각각 각 구성요소의 입력 가중치 결합, 순환 가중치 결합, 편향 결합입니다. 이러한 행렬은 다음과 같이 결합됩니다.</p>\[\begin{array}{l} W = \begin{bmatrix}W_i\\W_f\\W_g\\W_o\end{bmatrix}, R = \begin{bmatrix}R_i\\R_f\\R_g\\R_o\end{bmatrix}, b = \begin{bmatrix}b_i\\b_f\\b_g\\b_o\end{bmatrix} \end{array}\]<p>여기서 i, f, g, o는 입력게이트, 망각게이트, 셀 후보, 출력 게이트를 나타냅니다. 시간 스텝 t에서의 셀 상태는 다음과 같이 표현됩니다.</p>\[\begin{array}{l} c_t = f_t\odot c_{t-1}+i_t\odot g_t \end{array} \\ \odot \text{해당 기호는 요소별 곱셉(component-wise)을 뜻합니다.}\]<p>시간 스텝 t에서의 은닉 상태는 다음과 같이 표현됩니다.</p>\[h_t = o_t\odot\sigma_c(c_t)\]<p>여기서 <em>σ**c</em>는 상태 활성화 함수를 나타냅니다. <code class="language-plaintext highlighter-rouge">lstmLayer</code> 함수는 기본적으로 쌍곡탄젠트 함수(tanh)를 사용하여 상태 활성화 함수를 계산합니다.</p><p>다음 수식은 시간 스텝 t에서의 구성요소를 설명합니다.</p>\[\text{입력 게이트 식 :}\ i_t=\sigma_g(W_ix_t+R_ih_{t-1}+b_i) \\ \text{망각 게이트 식 :}\ f_t=\sigma_g(W_fx_t+R_fh_{t-1}+b_f) \\ \text{셀 후보 식 :}\ g_t=\sigma_c(W_gx_t+R_gh_{t-1}+b_g) \\ \text{출력 게이트 식 :}\ o_t=\sigma_g(W_ox_t+R_oh_{t-1}+b_o) \\ \text{위 식에서 } \sigma_g \text{는 게이트 활성함수를 나타냅니다. lstm layer 함수는 기본적으로 }\\\sigma(x)=(1+e^{-x})^{-1}\\ \text{로 표현되는 시그모이드 함수를 사용하여 게이트 활성화 함수를 계산합니다.}\]<hr /><p>끝으로 <code class="language-plaintext highlighter-rouge">MATLAB</code> 에서 확인할 수 있는 <code class="language-plaintext highlighter-rouge">LSTM</code> 의 출력 모드는 두 가지가 있습니다. <code class="language-plaintext highlighter-rouge">sequence</code> 와 <code class="language-plaintext highlighter-rouge">last</code> 인데요. <code class="language-plaintext highlighter-rouge">sequence</code> 는 전체 시퀀스를 출력하고, <code class="language-plaintext highlighter-rouge">last</code> 는 <code class="language-plaintext highlighter-rouge">sequence</code> 의 마지막 시간 스텝을 출력한다고 적혀있습니다.</p><h3 id="23-time-series-lstm"><span style="color:darkblue">2.3. Time series LSTM</span></h3><p>제가 처음으로 사용한 <code class="language-plaintext highlighter-rouge">LSTM</code> 은 영일번역과 다중객체인식으로 사용했습니다. 그러나 이번 포스팅에서 사용할 내용은 <code class="language-plaintext highlighter-rouge">시계열 LSTM</code> 인데요. 작은 차이밖에 없습니다. 분류는 <code class="language-plaintext highlighter-rouge">sequence to label</code> 로 설정하구요. 시계열은 <code class="language-plaintext highlighter-rouge">sequence to sequence</code> 신경망을 이용하여 시계열을 통해 시계열을 얻는 구조로 진행할 예정입니다.</p><h3 id="24-binomial-time-series-lstm"><span style="color:darkblue">2.4. Binomial time series LSTM</span></h3><p>일반적인 <code class="language-plaintext highlighter-rouge">시계열 예측</code> 은 회귀를 사용합니다. 예를 들면 3년 뒤면 우리 제품의 수요가 어느정도인가? 에 대한 질문에 답을 할 수 있죠. <code class="language-plaintext highlighter-rouge">이진 시계열 예측(Binomial time series)</code> 는 회귀를 <code class="language-plaintext highlighter-rouge">기준(threshold)</code> 치로 두고 <code class="language-plaintext highlighter-rouge">T/F, 맞냐/아니냐</code> 를 얘기합니다. 저희가 곧 구현할 로또당첨번호 예측을 얘기한다면, 1000회차에 17번이 나올 것인가 안 나올 것인가로 얘기하죠.</p><h2 id="3-implement"><span style="color:darkblue">3. Implement</span></h2><p>본격적으로 구현하는 시간입니다. 프로그램 순서는 역대 당첨번호를 긁어와 이진값으로 바꾸고 <code class="language-plaintext highlighter-rouge">LSTM</code> 을 돌려서 미래의 50회차를 예상하여 후보값들을 가져옵니다. 그 뒤 다시 <code class="language-plaintext highlighter-rouge">로또 당첨 통계</code> 웹 사이트에 접속해서 통계자료를 가져온 다음에 빈도수에 가중치를 두어 추출할 것 입니다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">clc</span><span class="p">,</span> <span class="nb">clear</span>
<span class="c1">% 사용할 금액 입력</span>
<span class="n">Money</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span>
</pre></table></code></div></div><p>초기 셋팅 먼저하고 시작하겠습니다.</p><h3 id="31-getting-history"><span style="color:darkblue">3.1. Getting History</span></h3><p>역대 당첨번호를 긁어와서 테이블을 만듭니다. <code class="language-plaintext highlighter-rouge">동행복권</code> 사이트에 들어가 소스를 확인해보니 <code class="language-plaintext highlighter-rouge">drwNo</code> 가 회차(1회, 2회, … ,950회 같은)를 담당하는 변수였습니다. <code class="language-plaintext highlighter-rouge">drwNo</code> 를 변경하면 각 회차의 당첨번호를 확인할 수 있습니다. 또한, 언제 끝날지 알기위해서 <code class="language-plaintext highlighter-rouge">waitbar</code> 를 이용하겠습니다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_9.png" alt="waitbar" /></p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c1">% 역대 당첨번호 긁어오기</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'https://dhlottery.co.kr/gameResult.do?method=byWin'</span><span class="p">;</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">webread</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="c1">% 얼마나 반복할지 구해온다</span>
<span class="n">startpoint</span> <span class="o">=</span> <span class="nb">strfind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'동행복권 '</span><span class="p">);</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="nb">strfind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'회'</span><span class="p">);</span>
<span class="n">lim</span> <span class="o">=</span> <span class="nb">str2num</span><span class="p">(</span><span class="n">data</span><span class="p">(</span><span class="n">startpoint</span><span class="o">+</span><span class="mi">5</span><span class="p">:</span><span class="n">endpoint</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>

<span class="n">header</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'1st'</span><span class="p">,</span> <span class="s1">'2nd'</span><span class="p">,</span> <span class="s1">'3rd'</span><span class="p">,</span> <span class="s1">'4th'</span><span class="p">,</span> <span class="s1">'5th'</span><span class="p">,</span> <span class="s1">'6th'</span><span class="p">,</span> <span class="s1">'Bonus'</span><span class="p">};</span>
<span class="n">HistorySet</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">lim</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span><span class="s1">''</span><span class="p">};</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">waitbar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">'Please wait...'</span><span class="p">);</span>
<span class="c1">% 데이터 가공해서 담기</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">lim</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">webread</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="s1">'drwNo'</span><span class="p">,</span><span class="nb">string</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="n">startpoint</span> <span class="o">=</span> <span class="nb">strfind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'당첨번호 '</span><span class="p">);</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="nb">strfind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'1등'</span><span class="p">);</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">(</span><span class="n">startpoint</span><span class="o">+</span><span class="mi">5</span><span class="p">:</span><span class="n">endpoint</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="nb">strsplit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="s1">','</span><span class="p">);</span>
    <span class="n">bonus</span> <span class="o">=</span> <span class="nb">strsplit</span><span class="p">(</span><span class="n">numbers</span><span class="p">{</span><span class="mi">6</span><span class="p">},</span><span class="s1">'+'</span><span class="p">);</span>
    <span class="n">HistorySet</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="p">[</span><span class="n">numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span> <span class="n">bonus</span><span class="p">];</span>
    <span class="nb">waitbar</span><span class="p">(</span><span class="n">i</span><span class="p">/</span><span class="n">lim</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="nb">strcat</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s1">'회차 완료'</span><span class="p">));</span>
<span class="k">end</span>
<span class="nb">delete</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">HistorySet</span> <span class="o">=</span> <span class="nb">cell2table</span><span class="p">(</span><span class="n">HistorySet</span><span class="p">,</span> <span class="s2">"VariableNames"</span><span class="p">,</span> <span class="n">header</span><span class="p">);</span>
<span class="nb">writetable</span><span class="p">(</span><span class="n">HistorySet</span><span class="p">,</span> <span class="s1">'temp.csv'</span><span class="p">)</span>
<span class="n">HistorySet</span> <span class="o">=</span> <span class="nb">readtable</span><span class="p">(</span><span class="s1">'temp.csv'</span><span class="p">,</span><span class="s2">"VariableNamingRule"</span><span class="p">,</span><span class="s2">"preserve"</span><span class="p">);</span>
<span class="nb">delete</span><span class="p">(</span><span class="s1">'temp.csv'</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="32-convert-type-to-binomial"><span style="color:darkblue">3.2. Convert type to binomial</span></h3><p><code class="language-plaintext highlighter-rouge">HistorySet</code> 에 들어가있는 테이블 형태는 아래와 같습니다. 이를 <code class="language-plaintext highlighter-rouge">Binomial</code> 형태로 바꾸면 <code class="language-plaintext highlighter-rouge">45짜리 행벡터</code> 에 해당하는 숫자가 1로 들어갑니다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_10.png" alt="historyset" /></p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">%dummy val 형태로 변환</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">waitbar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">'Please wait...'</span><span class="p">);</span>
<span class="n">Dummy</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">lim</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">lim</span>
    <span class="n">Dummy</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">HistorySet</span><span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="p">:})</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="nb">waitbar</span><span class="p">(</span><span class="n">i</span><span class="p">/</span><span class="n">lim</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="s1">'processing'</span><span class="p">);</span>
<span class="k">end</span>
<span class="nb">delete</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_11.png" alt="dummy" /></p><p>이렇게 말이죠.</p><h3 id="33-learning-lottos-pattern"><span style="color:darkblue">3.3. Learning lotto’s pattern</span></h3><p><code class="language-plaintext highlighter-rouge">LSTM</code> 을 이용해서 역대 당첨번호들을 학습시킵시다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="c1">%LSTM 학습</span>
<span class="c1">%numTimeStepsTrain = floor(0.9*length(Dummy));</span>

<span class="c1">%dataTrain = Dummy(1:numTimeStepsTrain+1, :);</span>
<span class="c1">%dataTest = Dummy(numTimeStepsTrain+1:end, :);</span>

<span class="n">dataTrain</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">;</span>

<span class="n">XTrain</span> <span class="o">=</span> <span class="n">dataTrain</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:);</span>
<span class="n">YTrain</span> <span class="o">=</span> <span class="n">dataTrain</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">,</span> <span class="p">:);</span>

<span class="n">numFeatures</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
<span class="n">numResponses</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
<span class="n">numHiddenUnits</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

<span class="n">layers</span> <span class="o">=</span> <span class="p">[</span> <span class="k">...</span>
    <span class="n">sequenceInputLayer</span><span class="p">(</span><span class="n">numFeatures</span><span class="p">)</span>
    <span class="n">lstmLayer</span><span class="p">(</span><span class="n">numHiddenUnits</span><span class="p">)</span>
    <span class="n">fullyConnectedLayer</span><span class="p">(</span><span class="n">numResponses</span><span class="p">)</span>
    <span class="n">regressionLayer</span><span class="p">];</span>

<span class="n">options</span> <span class="o">=</span> <span class="n">trainingOptions</span><span class="p">(</span><span class="s1">'adam'</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'MaxEpochs'</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'GradientThreshold'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'InitialLearnRate'</span><span class="p">,</span><span class="mf">0.005</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'LearnRateSchedule'</span><span class="p">,</span><span class="s1">'piecewise'</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'LearnRateDropPeriod'</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'LearnRateDropFactor'</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'Verbose'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="k">...</span>
    <span class="s1">'Plots'</span><span class="p">,</span><span class="s1">'training-progress'</span><span class="p">);</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">trainNetwork</span><span class="p">(</span><span class="n">XTrain</span><span class="s1">',YTrain'</span><span class="p">,</span><span class="n">layers</span><span class="p">,</span><span class="n">options</span><span class="p">);</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Lotto</code> 는 <code class="language-plaintext highlighter-rouge">Uniform</code> 분포에서 랜덤추출되는 메커니즘이기에 아무래도 좋은 <code class="language-plaintext highlighter-rouge">RMSE</code> 라고할 순 없네요.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_12.png" alt="result" /></p><h3 id="34-prediction"><span style="color:darkblue">3.4. Prediction</span></h3><p>미래 50회차를 예상해봅니다</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">%LSTM 미래스텝</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">predictAndUpdateState</span><span class="p">(</span><span class="n">net</span><span class="p">,</span><span class="n">XTrain</span><span class="o">'</span><span class="p">);</span>
<span class="p">[</span><span class="n">net</span><span class="p">,</span><span class="n">YPred</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictAndUpdateState</span><span class="p">(</span><span class="n">net</span><span class="p">,</span><span class="n">YTrain</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="p">:)</span><span class="o">'</span><span class="p">);</span>

<span class="n">numTimeStepsTest</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">:</span><span class="n">numTimeStepsTest</span>
    <span class="p">[</span><span class="n">net</span><span class="p">,</span><span class="n">YPred</span><span class="p">(:,</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">predictAndUpdateState</span><span class="p">(</span><span class="n">net</span><span class="p">,</span><span class="n">YPred</span><span class="p">(:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="s1">'ExecutionEnvironment'</span><span class="p">,</span><span class="s1">'cpu'</span><span class="p">);</span>
<span class="k">end</span>
</pre></table></code></div></div><p>해당 값에서 0.29보다 높은 애들만 추려서 <code class="language-plaintext highlighter-rouge">Binomial</code> 형태로 변환합니다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">% dummy val 형태로 변환</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">YPred</span> <span class="o">&gt;</span> <span class="mf">0.29</span><span class="p">;</span>
<span class="c1">% 번호로 돌려놓기</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">numTimeStepsTest</span>
    <span class="n">Candidate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span><span class="nb">find</span><span class="p">(</span><span class="n">temp</span><span class="p">(:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)};</span>
<span class="k">end</span>
<span class="n">Dummy</span><span class="p">(</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">+</span><span class="n">numTimeStepsTest</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">temp</span><span class="o">'</span><span class="p">;</span>
</pre></table></code></div></div><p>이렇게 말이죠.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/MATLAB/11_13.png" alt="data" /></p><h3 id="35-getting-statistical-data"><span style="color:darkblue">3.5. Getting statistical data</span></h3><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1">% 통계자료 획득</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'https://dhlottery.co.kr/gameResult.do?method=statByNumber'</span><span class="p">;</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">webread</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
</pre></table></code></div></div><p>웹에 들어가서 역대 통계자료를 가져옵니다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">% 데이터 파싱</span>
<span class="n">be</span> <span class="o">=</span> <span class="nb">strfind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'ballNoPop[0] ='</span><span class="p">);</span>
<span class="n">ed</span> <span class="o">=</span> <span class="nb">strfind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">'drwtNoPop[44] ='</span><span class="p">);</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">(</span><span class="n">be</span><span class="p">:</span><span class="n">ed</span><span class="o">+</span><span class="mi">21</span><span class="p">);</span>
</pre></table></code></div></div><p>1~45의 발생빈도를 가져와야되니까 해당 구간만 가져오구요.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">% 숫자데이터 추출</span>
<span class="n">tempData</span> <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">';'</span><span class="p">);</span>
<span class="n">tempData</span><span class="p">(</span><span class="k">end</span><span class="p">)</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">numData</span> <span class="o">=</span> <span class="nb">split</span><span class="p">(</span><span class="n">tempData</span><span class="p">,</span> <span class="s1">'='</span><span class="p">);</span>
</pre></table></code></div></div><p>숫자를 빼내옵니다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">% 계산가능한 형태로 변환</span>
<span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span> <span class="o">=</span> <span class="n">numData</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span><span class="p">)</span>
    <span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">extractBetween</span><span class="p">(</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span><span class="p">{</span><span class="n">i</span><span class="p">},</span><span class="s2">"'"</span><span class="p">,</span><span class="s2">"'"</span><span class="p">,</span><span class="s2">"Boundaries"</span><span class="p">,</span><span class="s2">"exclusive"</span><span class="p">);</span>
<span class="k">end</span>
<span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span> <span class="o">=</span> <span class="nb">str2num</span><span class="p">(</span><span class="nb">cell2mat</span><span class="p">(</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span><span class="p">));</span>

<span class="nb">rng</span><span class="p">(</span><span class="s1">'shuffle'</span><span class="p">);</span>
<span class="c1">% 발생빈도 내림차순 정렬</span>
<span class="p">[</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span><span class="p">,</span> <span class="n">Lotto</span><span class="o">.</span><span class="n">Num</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sort</span><span class="p">(</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Pop</span><span class="p">,</span> <span class="s1">'descend'</span><span class="p">);</span>
</pre></table></code></div></div><p>계산을 해야되니까 숫자형태로 바꾸고 내림차순으로 정렬했습니다.</p><h3 id="36-predict-lucky-number"><span style="color:darkblue">3.6. Predict lucky number</span></h3><p>번호추출은 <code class="language-plaintext highlighter-rouge">LSTM</code> 에서 가져온 번호와 가장 높은 빈도 15개의 교집합으로 얻은 숫자 3개, 중간 빈도 15개의 교집합으로 얻은 숫자 1개, 낮은 빈도 15개의 교집합으로 얻은 숫자 2개를 랜덤 생성하여 총 6개의 숫자를 얻습니다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c1">% 번호추출</span>
<span class="k">for</span> <span class="n">itr</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">numTimeStepsTest</span>
    <span class="n">Term</span> <span class="o">=</span> <span class="n">lim</span> <span class="o">+</span> <span class="n">itr</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">Money</span><span class="p">/</span><span class="mi">1000</span>
        <span class="nb">clearvars</span> <span class="n">Predicted</span> <span class="n">A</span> <span class="n">B</span> <span class="n">C</span>
        <span class="n">A</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="n">B</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">C</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">intersect</span><span class="p">(</span><span class="n">Candidate</span><span class="p">{</span><span class="n">itr</span><span class="p">},</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">15</span><span class="p">));</span>
        <span class="k">if</span> <span class="nb">length</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">A</span>
            <span class="n">A</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">A</span> <span class="o">~=</span> <span class="mi">0</span>
            <span class="n">Predicted</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">A</span><span class="p">)</span> <span class="o">=</span> <span class="n">datasample</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">'Replace'</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
        <span class="k">end</span>
        
        <span class="n">N</span> <span class="o">=</span> <span class="nb">intersect</span><span class="p">(</span><span class="n">Candidate</span><span class="p">{</span><span class="n">itr</span><span class="p">},</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="mi">16</span><span class="p">:</span><span class="mi">30</span><span class="p">));</span>
        <span class="k">if</span> <span class="nb">length</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">B</span>
            <span class="n">B</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">B</span> <span class="o">~=</span> <span class="mi">0</span>
            <span class="n">Predicted</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="p">)</span> <span class="o">=</span> <span class="n">datasample</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="s1">'Replace'</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
        <span class="k">end</span>
        
        <span class="n">N</span> <span class="o">=</span> <span class="nb">intersect</span><span class="p">(</span><span class="n">Candidate</span><span class="p">{</span><span class="n">itr</span><span class="p">},</span><span class="n">Lotto</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="mi">31</span><span class="p">:</span><span class="mi">45</span><span class="p">));</span>
        <span class="k">if</span> <span class="nb">length</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">C</span>
            <span class="n">C</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="k">if</span> <span class="n">C</span> <span class="o">~=</span> <span class="mi">0</span>
            <span class="n">Predicted</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">)</span> <span class="o">=</span> <span class="n">datasample</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="s1">'Replace'</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
        <span class="k">end</span>
        
        <span class="k">if</span> <span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span> <span class="o">&lt;</span> <span class="mi">6</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">Lotto</span><span class="o">.</span><span class="n">Num</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">15</span><span class="p">);</span>
            <span class="n">Predicted</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">datasample</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">6</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">),</span><span class="s1">'Replace'</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
        <span class="k">end</span>
        <span class="n">Result</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sort</span><span class="p">(</span><span class="n">Predicted</span><span class="p">)</span> <span class="n">Term</span><span class="p">];</span>
    <span class="k">end</span>
    <span class="n">PredictSet</span><span class="p">((</span><span class="n">itr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Money</span><span class="p">/</span><span class="mi">1000</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:(</span><span class="n">itr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Money</span><span class="p">/</span><span class="mi">1000</span><span class="p">),</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">Result</span><span class="p">;</span>
<span class="k">end</span>
</pre></table></code></div></div><h3 id="37-saving-numbers"><span style="color:darkblue">3.7. Saving numbers</span></h3><p>끝으로 만들어진 데이터를 2차 가공할 수도 있으니, <code class="language-plaintext highlighter-rouge">.csv</code> 로 저장합니다.</p><div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">header</span><span class="p">{</span><span class="k">end</span><span class="p">}</span> <span class="o">=</span> <span class="s1">'Round'</span><span class="p">;</span>
<span class="n">T</span> <span class="o">=</span> <span class="nb">array2table</span><span class="p">(</span><span class="n">PredictSet</span><span class="p">,</span><span class="s2">"VariableNames"</span><span class="p">,</span><span class="n">header</span><span class="p">);</span>
<span class="nb">writetable</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="s1">'BlessYou.csv'</span><span class="p">)</span>
</pre></table></code></div></div><p>행운을 빌겠습니다</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/matlab/'>MATLAB</a>, <a href='/categories/applied/'>Applied</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/matlab/" class="post-tag no-text-decoration" >MATLAB</a> <a href="/tags/algorithm/" class="post-tag no-text-decoration" >Algorithm</a> <a href="/tags/ai/" class="post-tag no-text-decoration" >AI</a> <a href="/tags/deeplearning/" class="post-tag no-text-decoration" >DeepLearning</a> <a href="/tags/statistics/" class="post-tag no-text-decoration" >Statistics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자! - 몬기의 기술공방&url=https://simonwithwoogi.github.io/posts/matlablotto/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자! - 몬기의 기술공방&u=https://simonwithwoogi.github.io/posts/matlablotto/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MATLAB, LSTM과 통계를 이용하여 Lotto 당첨번호 예측해보자! - 몬기의 기술공방&url=https://simonwithwoogi.github.io/posts/matlablotto/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Cpp_Trim/">C++_string_Trim</a><li><a href="/posts/Blazor_start/">Blazor_start</a><li><a href="/posts/projecthyundaithree/">Twitter Naver YouTube Crawler, 현대자동차 여론을 조사해보자(3)</a><li><a href="/posts/GitBlog2/">(깃블로그 운영-2) 테마를 다운받고 웹페이지를 확인해보자</a><li><a href="/posts/projecthyundaione/">Textmining, 현대자동차 여론을 조사해보자(1)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/matlab/">MATLAB</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/deeplearning/">DeepLearning</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/statistics/">Statistics</a> <a class="post-tag" href="/tags/improvement/">Improvement</a> <a class="post-tag" href="/tags/optimization/">Optimization</a> <a class="post-tag" href="/tags/quality/">Quality</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/matlabastaralgo/"><div class="card-body"> <span class="timeago small" > Sep 24, 2020 <i class="unloaded">2020-09-24T18:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MATLAB A* Algorithm을 실습하고 지도 데이터에 그리기</h3><div class="text-muted small"><p> 1. What is A* Algorithm 1.1. Informed Search Search, 탐색에 관하여 알아봅시다. 지금 가고 싶은 곳을 떠올려 봅시다. 그리고 현재위치에서 목적지까지 시간을 얼마나 걸릴까요? 비용은 얼마나 들까요? 또 어디를 거쳐가야 할까요? 인터넷에 검색해보면 빠르게 답을 찾을 수 있습니다. 그런데 사실 다른 방법으로...</p></div></div></a></div><div class="card"> <a href="/posts/matlabneuralnet1/"><div class="card-body"> <span class="timeago small" > Nov 4, 2020 <i class="unloaded">2020-11-04T00:07:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MATLAB Neural Network를 이해하고 SLP MLP의 학습원리를 이해해보자(1)!</h3><div class="text-muted small"><p> 이번 포스팅에는 귀여운 그림이 전혀 없습니다. 1. Neural Network 사람은 감각기관에서 받아들이는 내용에 대해 왜곡이 일어날 때가 있습니다. 이미 가지고 있는 지식때문인데요. 예능 프로그램에 검은 상자 속에 어떤 물컹한 물체를 놔두고 출연자들이 촉감으로 이 물체가 무엇인지 맞추는 게임을 종종 보셨을 겁니다. 재밌죠. 대부분 소스라치게 놀...</p></div></div></a></div><div class="card"> <a href="/posts/matlabneuralnet2/"><div class="card-body"> <span class="timeago small" > Nov 5, 2020 <i class="unloaded">2020-11-05T20:49:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MATLAB Neural Network를 이해하고 SLP MLP의 학습원리를 이해해보자(2)!</h3><div class="text-muted small"><p> 전편:Forward propagation 이번 포스팅에는 귀여운 그림이 전혀 없습니다. 1. Forward propagation [\begin{array}{l} h_1\ =\ w^1{11}x_1+w^1{21}x_2+c_1 h_2\ =\ w^1{12}x_1+w^1{22}x_2+c_2 \hat{h} = \hat{w}^{1’}\hat{x}+\ha...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/java-Conditional-Statements/" class="btn btn-outline-primary" prompt="Older"><p>JAVA_조건문</p></a> <a href="/posts/projecthyundaione/" class="btn btn-outline-primary" prompt="Newer"><p>Textmining, 현대자동차 여론을 조사해보자(1)</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/simonwithwoogi">Simon Anderson</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/matlab/">MATLAB</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/deeplearning/">DeepLearning</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/statistics/">Statistics</a> <a class="post-tag" href="/tags/improvement/">Improvement</a> <a class="post-tag" href="/tags/optimization/">Optimization</a> <a class="post-tag" href="/tags/quality/">Quality</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://SimonWithWoogi.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
